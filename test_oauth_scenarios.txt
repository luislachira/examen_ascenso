â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIOS DE PRUEBA - OAUTH GOOGLE/MICROSOFT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… MEJORAS APLICADAS:
--------------------
1. DiferenciaciÃ³n entre registro nuevo y login existente
2. Manejo correcto de estados (Activo, Pendiente, Suspendido)
3. Logging detallado para debugging
4. Mensajes personalizados segÃºn el caso


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIO 1: USUARIO NUEVO (Primera vez con Google)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASOS:
------
1. Abre: https://examen-ascenso.com
2. Haz clic en "Sign in with Google"
3. Selecciona una cuenta de Google que NUNCA has usado antes

RESULTADO ESPERADO:
-------------------
âœ… Usuario se crea en BD con estado PENDIENTE ('2')
âœ… Se muestra el mensaje elegante:

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚              â³                     â”‚
   â”‚       Registro Exitoso              â”‚
   â”‚                                     â”‚
   â”‚  Tu cuenta ha sido creada           â”‚
   â”‚  correctamente.                     â”‚
   â”‚                                     â”‚
   â”‚  Por favor, espera hasta que el     â”‚
   â”‚  administrador acepte tu solicitud. â”‚
   â”‚                                     â”‚
   â”‚    [Volver al Login]               â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

VERIFICACIÃ“N:
-------------
php check_usuarios.php

DeberÃ­as ver el nuevo usuario con:
  ğŸŸ¡ Estado: PENDIENTE


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIO 2: USUARIO EXISTENTE PENDIENTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASOS:
------
1. Cierra sesiÃ³n de Google en el navegador
2. Ve a: https://examen-ascenso.com
3. Haz clic en "Sign in with Google"
4. Usa la MISMA cuenta de Google del Escenario 1

RESULTADO ESPERADO:
-------------------
âœ… Sistema detecta que el usuario ya existe
âœ… Verifica que estÃ¡ en estado PENDIENTE
âœ… Se muestra el MISMO mensaje elegante:

   "Espera que el administrador acepte tu solicitud"

âŒ NO crea un usuario duplicado
âŒ NO permite acceso al dashboard


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIO 3: USUARIO ACTIVO (Aprobado por admin)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PREPARACIÃ“N:
------------
1. Aprobar al usuario manualmente:

   php artisan tinker --execute="
   \$user = App\Models\Usuario::where('correo', 'TU_EMAIL@gmail.com')->first();
   \$user->estado = '1';
   \$user->save();
   echo 'Usuario aprobado';
   "

PASOS:
------
1. Cierra sesiÃ³n de Google en el navegador
2. Ve a: https://examen-ascenso.com
3. Haz clic en "Sign in with Google"
4. Usa la misma cuenta de Google

RESULTADO ESPERADO:
-------------------
âœ… Sistema detecta que el usuario existe y estÃ¡ ACTIVO
âœ… Genera un token de autenticaciÃ³n
âœ… Redirige DIRECTAMENTE al dashboard
âœ… NO muestra el mensaje de "espera aprobaciÃ³n"

VERIFICACIÃ“N:
-------------
- DeberÃ­as estar dentro del sistema
- DeberÃ­as ver el dashboard segÃºn tu rol


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIO 4: USUARIO SUSPENDIDO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PREPARACIÃ“N:
------------
1. Suspender al usuario manualmente:

   php artisan tinker --execute="
   \$user = App\Models\Usuario::where('correo', 'TU_EMAIL@gmail.com')->first();
   \$user->estado = '0';
   \$user->save();
   echo 'Usuario suspendido';
   "

PASOS:
------
1. Cierra sesiÃ³n de Google en el navegador
2. Ve a: https://examen-ascenso.com
3. Haz clic en "Sign in with Google"
4. Usa la misma cuenta de Google

RESULTADO ESPERADO:
-------------------
âœ… Sistema detecta que el usuario estÃ¡ SUSPENDIDO
âœ… NO permite acceso
âœ… Redirige al login con mensaje de error:

   "Su cuenta ha sido suspendida. Contacte al administrador."

âŒ NO genera token
âŒ NO muestra mensaje de "espera aprobaciÃ³n"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ESCENARIO 5: MÃšLTIPLES REGISTROS (Google y Microsoft)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASOS:
------
1. Registrarse con Google (usuario1@gmail.com)
2. Ver mensaje de espera
3. Hacer clic en "Volver al Login"
4. Registrarse con Microsoft (usuario2@outlook.com)
5. Ver mensaje de espera

RESULTADO ESPERADO:
-------------------
âœ… Cada cuenta crea un usuario diferente
âœ… Ambos con estado PENDIENTE
âœ… Ambos muestran el mensaje de espera
âœ… NO hay conflictos entre proveedores


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  VERIFICACIÃ“N DE LOGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para ver quÃ© estÃ¡ pasando internamente:

Get-Content "C:\wamp64\www\laravel\examen_ascenso\storage\logs\laravel.log" -Wait -Tail 30

DeberÃ­as ver logs como:

âœ… Usuario nuevo:
   - "Nuevo usuario creado via OAuth"
   - es_nuevo: true
   - estado: 2

âœ… Usuario existente:
   - "Usuario existente encontrado"
   - es_nuevo: false
   - estado: (el que tenga)

âœ… Login exitoso:
   - "Login exitoso con OAuth"
   - Token generado

âœ… Cuenta pendiente:
   - "Usuario con cuenta pendiente"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  COMANDOS ÃšTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ver usuarios registrados
php check_usuarios.php

# Aprobar un usuario especÃ­fico
php artisan tinker --execute="
App\Models\Usuario::where('correo', 'EMAIL')->update(['estado' => '1']);
echo 'Usuario aprobado';
"

# Suspender un usuario
php artisan tinker --execute="
App\Models\Usuario::where('correo', 'EMAIL')->update(['estado' => '0']);
echo 'Usuario suspendido';
"

# Ver logs en tiempo real
Get-Content storage\logs\laravel.log -Wait -Tail 50


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  RESUMEN DE ESTADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Estado '0' (SUSPENDIDO):
  - âŒ NO puede iniciar sesiÃ³n
  - âš ï¸ Mensaje: "Cuenta suspendida"
  - ğŸ”´ Icono: Rojo

Estado '1' (ACTIVO):
  - âœ… Puede iniciar sesiÃ³n
  - âœ… Accede directamente al dashboard
  - ğŸŸ¢ Icono: Verde

Estado '2' (PENDIENTE):
  - âŒ NO puede iniciar sesiÃ³n
  - â³ Mensaje: "Espera aprobaciÃ³n"
  - ğŸŸ¡ Icono: Amarillo


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Â¿PROBLEMAS?
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Si algo no funciona como esperado:

1. Revisa los logs:
   storage\logs\laravel.log

2. Verifica la base de datos:
   php check_usuarios.php

3. Confirma el estado del usuario:
   php artisan tinker --execute="
   App\Models\Usuario::where('correo', 'EMAIL')
     ->get(['idUsuario','correo','estado'])
   "

4. Limpia la sesiÃ³n de OAuth:
   - Cierra sesiÃ³n de Google/Microsoft en el navegador
   - Borra cookies de examen-ascenso.com
   - Intenta de nuevo


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
